<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<title>Sylvester Test Suite</title>
<script src="../lib/sylvester.js" type="text/javascript"></script>
<script src="test.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="test.css" />
<script type="text/javascript">

var summary, i, A, V, V1, V2, M, M1, M2, L, L1, L2, P, P1, P2;
var begin = new Date().getTime();

window.onload = function() {

  resultList = document.getElementById('results');
  
  title('Setup');
  assert('Test assertion', true);
  
  title('Plane tests');
  
  assert('Equality and duplication',
    Plane.XY.dup().eql($P([34,-99,0], [0,0,-4]))
  );
  
  assert('Translation',
    Plane.XY.dup().translate([5,12,-14]).eql($P([89,-34,-14], Vector.k))
  );
  
  assert('Parallel to plane',
    Plane.XY.dup().translate([5,12,-14]).isParallelTo(Plane.XY)
  );
  
  assert('Parallel to line',
    Plane.XY.isParallelTo($L([4,8,10], [2,-6,0]))
  );
  
  assert('Distance from plane',
    Plane.XY.dup().translate([5,12,-14]).distanceFrom(Plane.XY) == 14
  );
  
  assert('Distance from intersecting plane',
    Plane.XY.dup().translate([5,12,-14]).distanceFrom($P([0,0,0], [1,0,1])) === 0
  );
  
  assert('Distance from line',
    Plane.XY.distanceFrom($L([4,8,10], [2,-6,0])) == 10
  );
  
  assert('Distance from intersecting line',
    Plane.XY.distanceFrom($L([4,8,10], [2,-6,2])) === 0
  );
  
  assert('Contains line',
    Plane.XY.contains(Line.X)
  );
  
  assert('Contains point',
    Plane.XY.contains(Vector.i)
  );
  
  assert('Closest point',
   Plane.YZ.pointClosestTo($V([3,6,-3])).eql($V([0,6,-3]))
  );
  
  assert('Rotation',
    Plane.XY.rotate(Math.PI/2, Line.Y).eql(Plane.YZ)
  );
  
  assert('Reflection in a point',
    Plane.XY.reflectionIn($V([12,65,-4])).eql($P([0,0,-8], Vector.k))
  );
  
  assert('Reflection in a perpendicular line',
    Plane.XY.reflectionIn(Line.Z).eql(Plane.XY)
  );
  
  assert('Reflection in some line',
    Plane.XY.reflectionIn($L([0,0,0], [1,0,1])).eql(Plane.YZ)
  );
  
  assert('Reflection in a plane',
     $P([5,0,0], [1,1,0]).reflectionIn($P([5,0,0], [0,1,0])).eql($P([5,0,0], [-1,1,0]))
  );
  
  assert('Reflection in a plane, cycled',
     $P([0,5,0], [0,1,1]).reflectionIn($P([0,5,0], [0,0,1])).eql($P([0,5,0], [0,-1,1]))
  );
  
  assert('Reflection in a plane, cycled again',
     $P([0,0,5], [1,0,1]).reflectionIn($P([0,0,5], [1,0,0])).eql($P([0,0,5], [1,0,-1]))
  );
  
  for (i = 1; i <= 10; i++) {
    P1 = $P($V([-50,-50,-50]).add(Vector.Random(3).x(100)), $V([-50,-50,-50]).add(Vector.Random(3).x(100)));
    P2 = $P($V([-50,-50,-50]).add(Vector.Random(3).x(100)), $V([-50,-50,-50]).add(Vector.Random(3).x(100)));
    if (P1.intersects(P2)) {
      L1 = P1.intersectionWith(P2);
      L2 = P2.intersectionWith(P1);
      assert('Intersection test ' + i,
        L1.eql(L2) && L1.liesIn(P1) && P2.contains(L1)
      );
    }
  }
  
  summary = document.getElementById('summary');
  var fin = new Date().getTime();
  var time = fin - begin;
  summary.innerHTML = 'Tests completed in ' + time/1000 + ' seconds. ' + nTests + ' assertions, ' + nFailures + ' failures.';
};

</script>
</head>
<body>

<h1>Sylvester Test Suite</h1>

<p id="summary"></p>

<ul id="results">
</ul>

</body>
</html>
